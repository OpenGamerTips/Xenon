#include "Main.hpp"
using Xenon::Console;
using Xenon::Utility;

ulong rL;
void GetRobloxLuaState()
{
	Console::Info(0, OBFUSCATESTR("Getting Lua State..."));
	rL = EyeStep::util::debug_r32(RLua::GettopAddr + 3, EyeStep::R32_EBP, 8, 1)[0];
}

void LoadLBI()
{
	ulong LBIrL = RLua::newthread(rL);
	setthreadidentity(LBIrL, 7);
	Console::Info(0, OBFUSCATESTR("Loading LBI..."));
	std::string LBIByte = "017206536f7572636508506f736974696f6e016e017001750176014107496e7453697a65056572726f7211496e76616c696420696e742073697a652e01460653697a655f5414496e76616c69642073697a655f742073697a652e01470001481b496e76616c69642062797465636f6465207369676e61747572652e06617373657274254c75612062797465636f64652076657273696f6e206e6565647320746f20626520352e312e3042797465636f646520666f726d6174206d75737420626520696e206c6974746c6520656e6469616e20666f726d61742e014b044e616d650953746172744c696e6507456e644c696e65044e757073074e706172616d730849735661726172670c4d6178537461636b53697a650c496e737472756374696f6e73064f70636f64650454797065014201430242780373427809436f6e7374616e74730650726f746f73054c696e6573064c6f63616c7308557076616c756573054465627567015802613906756e7061636b2542797465636f6465206861732061207072652d636f6d70696c6174696f6e206572726f722e06506172656e7405496e6465780c7365746d6574617461626c65075f5f696e6465780a5f5f6e6577696e6465780261730767657466656e76057063616c6c0474797065057461626c65135e282e2d293a2825642b293a25732b282e2b29013a013f023a20015a026141044d4f5645054c4f41444b084c4f4144424f4f4c074c4f41444e494c08474554555056414c09474554474c4f42414c084745545441424c4509534554474c4f42414c08534554555056414c085345545441424c45084e45575441424c450453454c460341444403535542034d554c03444956034d4f4403504f5703554e4d034e4f54034c454e06434f4e434154034a4d50024551024c54024c45045445535407544553545345540443414c4c085441494c43414c4c0652455455524e07464f524c4f4f5007464f52505245500854464f524c4f4f50075345544c49535405434c4f534507434c4f535552450656415241524703626974056269743332077265717569726506727368696674066c73686966740462616e6406737472696e670373756204677375620462797465077265766572736506636f6e636174056d61746368025f470c6c6f616462797465636f64653a0600030018c0000000fb0300004d02034200000000fb0400004d03043b01000000fb0500004d04053b010000004c2d0001fb0101009f0104004c290001fb0002009f000002fb010000fb0400004d03043b01000000950203023002013b0100000082000200030301030202000000000000f03f0003011800000000000000000000000000000000000000000000000001000000000900010013c0000000fb0400009f04010252000400fb0400009f04010252010400fb0400009f04010252020400fb0300009f0301025b0703005b080201430607085b0701024305060743040500820402000302000000000000704102000000000000f040020000000000007040000401180000000000000000000000000000000000000001000000000300010008c0000000fb0200009f0201025b010200fb0200009f02010243000102820002000102000000000000f04100050118000000000000000001000000000d0004004dc0000000fb0400009f04010252000400fb0400009f04010252010400fb0400009f04010252020400fb0300009f0301028c080100fb090100520a03008c0b07009f090302b207080939040700fb070100520802008c0907009f070302fb080200fb090300520a03008c0b7f009f0903028c0a01009f08030243050708fb080200520901008c0a08009f08030243070008fb080200fb090300520a02008c0b7f009f0903028c0a10009f080302430607088c0701008c0800009a050900080000008c0800009a060300080000005b080400820802008c0700008c05010065000c008c087f009a050a00080000008c0800009a060400080000005b0904013e080900820802005b0904003e080900820802008c0b0200780c0502b20a0b0c0909040a8c0b01003e0c0703430a0b0c0908090a820802000402000000000000000002000000000000f03f020000000000c05f400200000000000060410006011800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000120004005ac0000000fb0800009f08010252000800fb0800009f08010252010800fb0800009f08010252020800fb0800009f08010252030800fb0800009f08010252040800fb0800009f08010252050800fb0800009f08010252060800fb0700009f0701028c0b0100fb0c0100520d07008c0e07009f0c0302b2080b0cfb0b0200fb0c0300520d07008c0e7f009f0c03028c0d04009f0b0302fb0c0100520d06008c0e04009f0c030243090b0cfb0b0300520c06008c0d0f009f0b03025b0a0b008c0b01005b11050143100a115b110402430f10115b100303430e0f105b0f0204430d0e0f5b0e0105430c0d0e430a0c008c0c00009a0909000c0000008c0c00009a0a03000c0000005b0c0806820c02008c0b00008c09010065000c008c0cff079a090a000c0000008c0c00009a0a04000c0000005b0d08073e0c0d06820c02005b0d08063e0c0d06820c02008c0f020078100908b20e0f10090d080e3e0f0a09430e0b0f090c0d0e820c02000a02000000000000f04202000000000000704202000000000000f04102000000000000704102000000000000f04002000000000000704002000000000000000002000000000000f03f020000000000f88f400200000000000030430007011800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000300030019c0000000fb0100004d0001f9000000008c0104009a00040001000000fb0001009f00010082000000fb0100004d0001f9000000008c0108009a00040001000000fb0002009f00010082000000a4000200000010406f0103008c0202009f0003018200010004030803090400001040030a000b01180000000000000000000000000000000000000000000000000001000000000300030019c0000000fb0100004d00013f000000008c0104009a00040001000000fb0001009f00010082000000fb0100004d00013f000000008c0108009a00040001000000fb0002009f00010082000000a4000200000010406f0103008c0202009f0003018200010004030c03090400001040030d000e01180000000000000000000000000000000000000000000000000001000000000801030020c00100002b000300fb0100009f010102520001008c0100009a000300010000006f01000082010200fb0301004d02034201000000fb0401004d03043b02000000fb0701004d06073b0200000043050600780405034c2d0001fb0102009f010402fb020100fb0501004d04053b02000000430304003003023b020000008201020004030f0301030202000000000000f03f00100118000000000000000000000000000000000000000000000000000000000000000001000000000400030039c0000000fb0200009f0201026f030000f102020003000000a9010001a90101006f0201004c010002a4000300000020409f000301fb0201009f0201028c035100f102020003000000a9010001a90101006f0204004c010002a4000300000020409f000301fb0001009f000101fb0201009f0201028c030100f102020003000000a9010001a90101006f0205004c010002a4000300000020409f000301fb000200fb0101009f010102300100f906000000fb000200fb0101009f0101023001003f07000000fb0001009f000101fb0001009f000101fb0001009f000101a90001008200020008020000c006535dd841031103120400002040031303140308030c0015011800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000d000c00ff01c0000000ff00000000000000fb0200009f0201028c0301008c04feff4c2d0001fb0101009f010402300100ba00000000fb0102009f010102300100a501000000fb0102009f0101023001009802000000fb0103009f0101023001001203000000fb0103009f0101023001008604000000fb0103009f010102300100df05000000fb0103009f0101023001002b06000000ff0100000000000030010085070000008c030100fb0402009f040102520104008c020100a8014f00fb0404009f040102fb050500520604008c073f009f050302fb07060087060705e2070b003005070908000000c60800003008071109000000fb080500fb090700520a04008c0b06009f0903028c0aff009f080302300807600a0000008c0801009a06140008000000fb080500fb090700520a04008c0b17009f0903028c0aff019f080302300807630c000000fb080500fb090700520a04008c0b0e009f0903028c0aff019f080302300807620d00000065001a008c0802009a060b0008000000fb080500fb090700520a04008c0b0e009f0903026f0a0e009f0803023008070a0f00000065000d008c0803009a060b0008000000fb090500fb0a0700520b04008c0c0e009f0a03026f0b0e009f090302780809103008079011000000fb09080087080905300807ba000000004d080085070000006a0708038b01b1ffff0100000000000030010007120000008c030100fb0402009f040102520104008c020100a8012500c6040000fb0503009f0501028c0601009a05090006000000fb0603009f0601028c0700009a06020007000000a9040001a9040100650012008c0603009a05050006000000fb0609009f0601025204060065000b008c0604009a05090006000000fb0700009f0701028c0801008c09feff4c2d0001fb0601009f060402520406004d06000712000000780703136a0406078b01dbffff010000000000003001007c140000008c030100fb0402009f040102520104008c020100a80108004d04007c1400000078050313fb060a00fb070b009f0602026a0604058b01f8ffe2011800ff020000000000003002010115000000ff020000000000003002011c16000000ff02000000000000300201911700000030010072190000008c030100fb0402009f040102520104008c020100a8010800fb0404009f0401024d060072190000004d050601150000006a0405038b01f8ff8c030100fb0402009f040102520104008c020100a8010f00fb0400009f040102fb050b00fb080b004d07083b1b0000009506071a3006053b1b0000004d060072190000004d05061c160000006a0405038b01f1ff8c030100fb0402009f040102520104008c020100a8010800fb0400009f0401024d060072190000004d050691170000006a0405038b01f8ff820002001c0316031703180319031a031b031c031d031e031f0307050308090a032003210200000000f8ff0f4103220200000000f0ffff400323032402000000000000f03f03250326032703280503151617032902000000000000204003020000011800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000201030009c0010000fb0100003000014200000000fb0101009f010101fb0102009f01010082010000010301002a01180000000000000000000100000000040102000bc00100008c01ff007d00040001000000fb0200008701020082010200fb02010078030000870102038201020001020000000000007040002b011800000000000000000000000100000000060101000ac0010000fb0100004d02006000000000fb0400004d05006301000000870304056a03010282000100020307032000000118000000000000000000000100000000060102000ac0010000fb0100004d02006000000000fb0401004d05000a01000000870304056a030102820001000203070322000001180000000000000000000001000000000601020015c0010000fb0100004d020060000000004d040063010000008c0500009a04020005000000a9030001a90301006a0301024d010062020000008c020000f101040002000000fb02010095010203de010100820001000403070320032102000000000000f03f000001180000000000000000000000000000000000000000000100000000060101000cc00100004d030060000000004d010063010000008c020100a8010400fb040000c60500006a0504038b01fcff820001000203070320000001180000000000000000000000000100000000060102000ac0010000fb0100004d02006000000000fb0401004d05006301000000870304056a03010282000100020307032000000118000000000000000000000100000000080103000cc0010000fb0100004d02006000000000fb040100fb0602004d07000a0100000087050607870304056a030102820001000203070322000001180000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0500004d0600630100000087040506fb0501004d060062020000009f050202870304056a0301028200010003030703200321000001180000000000000000000000000000000100000000060103000cc0010000fb010000fb0301004d04000a0000000087020304fb0402004d05006001000000870304056a030102820001000203220307000001180000000000000000000000000100000000060102000ac0010000fb0100004d02006300000000fb0401004d05006001000000870304056a03010282000100020320030700000118000000000000000000000100000000050102000fc0010000fb0200004d0300600000000087010203fb0201004d030063010000009f020202fb0301004d040062020000009f0302026a03010282000100030307032003210000011800000000000000000000000000000001000000000401010008c0010000fb0100004d02006000000000ff030000000000006a0301028200010001030700000118000000000000000001000000000801020014c00100004d010060000000004d02006301000000fb0300004d040062020000009f030202fb04010095050103fb070100870607026a060405fb040100fb07010087060702870506036a050401820001000403070320032102000000000000f03f0000011800000000000000000000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0401004d050063010000009f040202fb0501004d060062020000009f050202430304056a0301028200010003030703200321000001180000000000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0401004d050063010000009f040202fb0501004d060062020000009f050202260304056a0301028200010003030703200321000001180000000000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0401004d050063010000009f040202fb0501004d060062020000009f050202090304056a0301028200010003030703200321000001180000000000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0401004d050063010000009f040202fb0501004d060062020000009f050202ec0304056a0301028200010003030703200321000001180000000000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0401004d050063010000009f040202fb0501004d060062020000009f050202cf0304056a0301028200010003030703200321000001180000000000000000000000000000000100000000070102000fc0010000fb0100004d02006000000000fb0401004d050063010000009f040202fb0501004d060062020000009f050202b20304056a0301028200010003030703200321000001180000000000000000000000000000000100000000070101000bc0010000fb0100004d02006000000000fb0500004d0600630100000087040506390304006a0301028200010002030703200000011800000000000000000000000100000000070101000bc0010000fb0100004d02006000000000fb0500004d0600630100000087040506560304006a0301028200010002030703200000011800000000000000000000000100000000070101000bc0010000fb0100004d02006000000000fb0500004d06006301000000870405061c0304006a03010282000100020307032000000118000000000000000000000001000000000801020017c0010000ff010000000000004d040063000000004d020062010000008c030100a80206001c06010095050602fb070000870607046a0601058b02fafffb0200004d03006003000000fb040100520501009f0402026a04020382000100040320032102000000000000f03f030700000118000000000000000000000000000000000000000000000001000000000401010007c0010000fb0200004d0300900000000043010203de0100008200010001032300000118000000000000000100000000050102001ac0010000fb0200004d030063000000009f020202fb0300004d040062010000009f030202f102020003000000a9010001a90101004d030060020000008c0400009a03020004000000a9020001a9020100f101040002000000fb02010095010203de010100820001000403200321030702000000000000f03f0000011800000000000000000000000000000000000000000000000000000100000000050102001ac0010000fb0200004d030063000000009f020202fb0300004d040062010000009f030202b702020003000000a9010001a90101004d030060020000008c0400009a03020004000000a9020001a9020100f101040002000000fb02010095010203de010100820001000403200321030702000000000000f03f0000011800000000000000000000000000000000000000000000000000000"
	"100000000050102001ac0010000fb0200004d030063000000009f020202fb0300004d040062010000009f030202d402020003000000a9010001a90101004d030060020000008c0400009a03020004000000a9020001a9020100f101040002000000fb02010095010203de010100820001000403200321030702000000000000f03f00000118000000000000000000000000000000000000000000000000000001000000000501010012c00100004d0300600000000056020300560102004d030062010000008c040000f103020004000000a9020001a90201009a01040002000000fb02000095010202de01000082000100030307032102000000000000f03f0000011800000000000000000000000000000000000001000000000601020019c00100004d0100630000000056030100560203004d040062010000008c050000f104020005000000a9030001a90301009a02050003000000fb03000095020302de02000082000100fb0201004d03006003000000fb050100870405016a04020382000100040320032102000000000000f03f0307000001180000000000000000000000000000000000000000000000000001000000000e0102004fc00100004d010060000000004d020063010000004d03006202000000ff04000000000000c60500008c060000c60700008c0801009a020b0008000000ff08000001000000fb0a000087090a019f090100c508090001000000520708001c05070065001f008c080000f102040008000000430801027805080365000100fb050100950a0103520805008c090100a808050095060603fb0c0000870b0c0a6a0b04068b08fbffff08000001000000fb0a000087090a01a40a050000004040520b04008c0c0100260d05019f0a04009f090000c508090001000000520708001c0507008c06000078080103de0801008c080100f1031100080000008c080000f10304000800000043080103780508066500010043050501520a0100520805008c090100a808050095060603fb0b0000870c07066a0c0b0a8b08fbff820001000703070320032102000000000000f03f032c0400004040020000000000000040000001180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000c01020035c00100004d010060000000004d02006301000000ff03000000000000c60400008c0500008c0601009a020a0006000000ff06000001000000fb080000870708019f070100c50607000100000052050600820502008c060000f102040006000000430601027804060265000100fb04010095080102520604008c070100a80606001c0a030095090a02fb0b0000870a0b086a0a03098b06faffff06000001000000fb08000087070801a408040000003040520903008c0a0100260b04019f0804009f070000c5060700010000005205060082050200050307032002000000000000f03f032c040000304000000118000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000b01020023c00100004d010060000000004d02006301000000ff030000000000008c040000c60500008c0600009a02030006000000fb05000065000b008c0601009a02070006000000ff06000001000000c6070000c50607020100000082060200430601027805060252080100520605008c070100a806050095040403fb0a010087090a086a0903048b06fbff82030200040307032002000000000000004002000000000000f03f0000011800000000000000000000000000000000000000000000000000000000000000000000000100000000070102002ac00100004d01006000000000fb0300009504010187020304fb0500008704050143030402fb0400006a0304018c04000060040f0002000000fb05000095060102870405067d03170004000000fb0501004d0600900300000043040506de040100fb040000950501046a03040582000100fb05000095060102870405067d04090003000000fb0501004d0600900300000043040506de040100fb040000950501046a0304058200010005030702000000000000004002000000000000f03f03230200000000000008400000011800000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000801020011c00100004d01006000000000fb020000fb05000087040501fb0600009507010187050607260304056a030201fb0301004d0400900200000043020304de02010082000100030307020000000000000040032300000118000000000000000000000000000000000001000000000a0102002ac00100004d0100600000000095020101ff03000001000000fb05000087040501fb0600009507010287050607fb07000095080101870607089f040300c5030400010000008c0601004d040062030000008c050100a8040500fb07000043080206870903066a0907088b04fbfffb05000095060104870405060e040700fb04000095050101fb07000095080104870607086a06040582000100fb05010095040502de0401008200010005030702000000000000004002000000000000f03f03210200000000000008400000011800000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000d01020023c00100004d010060000000004d020063010000004d030062020000008c040000f103150004000000780503045b0405038c0701008c0800009a02030008000000fb0500002b050100520502008c060100a8050d00fb0901008708090143090407fb0b0100430c0107870a0b0c6a0a08098b05f8ff82000100a4040600000050406f0507009f040201820001000803070320032102000000000000494002000000000000f03f03090400005040032d00000118000000000000000000000000000000000000000000000000000000000000000000000001000000000101000002c0010000820001000000000118000001000000000602010009c0020000fb030000870203014d040224000000004d0502e201000000870304058203020002032e032f0000011800000000000000000001000000000603010009c0030000fb040000870304014d040324000000004d0503e2010000006a0204058200010002032e032f0000011800000000000000000001000000000b01060044c0010000fb0200004d03000a0000000087010203ff02000000000000a403020000001040ff04000000000000e2050500d9060000120002003006056e03000000d906010012000200300605ce040000009f0303028c0601004d040191060000008c050100a8042100fb080100fb090200870708094d080709070000008c0900009a080c000900000078080608e2090b00fb0a0300300a0924090000004d0a07630c000000300a09e20a0000006a09020865000a0078080608e2090b00fb0a0400300a0924090000004d0a07630c000000300a09e20a0000006a090208fb09020095080908de0802008b04dffffb0403004d0500600d000000fb06050052070100520803009f0603026a060405820001000e03220330040000104003310332050203040328031e02000000000000f03f032e032f0502090a03200307023031000118000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000a01030016c00100004d010060000000004d02006301000000520501008c0700006007030002000000780602022b060100fb060000430301068c040100a8030600fb060100fb08020026090501870708096a0706058b03faff82000100030307032002000000000000f03f000001180000000000000000000000000000000000000000000001000000000500030016c0000000c60000002b001200fb0300004d02038500000000fb030100870102032b01010082000100fb0302004d0401090100000087020304520301009f02020252000200fb03010095020302de0201004800edff8200020003031d031e02000000000000f03f003301180000000000000000000000000000000000000000000001000000000403020009c0030000fb03000060030300010000000e020100de010000fb0301006a0203018200010000000001180000000000000000000100000000130009015da3000000ff00000000000000dd010000c500010001000000ff01000000000000de0100001c02000078010200de010100a4010200000010409f010102de010200ff01000000000000ff020000000000008c03ffffde030300a40304000000304052040100e20507003002056e05000000d90600001202030012000200300605ce060000009f030302de0304008c050000fb0301008c040100a803080095070500870600076a060105fb06000095080500870700086a0706058b03f8ff8c030100de030500a403090000008040fb0406009f0302030e030f00520704004c280002a4060b000000a0409f0602026f070c009a06060007000000a4050e000000d040520604009f0502022b0501005205040082050200fb050700520604006f070f009f050304a408110000000041fb0f08004d0a0fba120000006f0b1300fb1208004d111272150000004d10110116000000fb110500870f1011900c0f146f0d1700520e070073090a0e8c0a00009f080301820001001802000000000000f03f03340400001040033004000030400331033205020506033504000080400336040000a0400337032c040000d04003380309040000004103160339033a03290326033b013500011800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000f020300df01c00200004d020085000000008c0301004d04007c010000004d05000702000000c6060000ff070000000000008c080000ff090000000000008c0a0000d90b00001201070012000500ff0c0700000000008c0d0000d90e0100120107006a0e0c0d8c0d0100d90e020012010700120005006a0e0c0d8c0d0200d90e030012010700120103006a0e0c0d8c0d0300d90e0400120107006a0e0c0d8c0d0400d90e050012010700120001006a0e0c0d8c0d0500d90e06001201070012010600120005006a0e0c0d8c0d0600d90e07001201070012000b006a0e0c0d8c0d0700d90e08001201060012000500120107006a0e0c0d8c0d0800d90e090012000100120107006a0e0c0d8c0d0900d90e0a001201070012000b006a0e0c0d8c0d0a00d90e0b00120107006a0e0c0d8c0d0b00d90e0c0012000b00120107006a0e0c0d8c0d0c00d90e0d001201070012000b006a0e0c0d8c0d0d00d90e0e001201070012000b006a0e0c0d8c0d0e00d90e0f001201070012000b006a0e0c0d8c0d0f00d90e10001201070012000b006a0e0c0d8c0d1000d90e11001201070012000b006a0e0c0d8c0d1100d90e12001201070012000b006a0e0c0d8c0d1200d90e1300120107006a0e0c0d8c0d1300d90e1400120107006a0e0c0d8c0d1400d90e1500120107006a0e0c0d8c0d1500d90e160012010700120200006a0e0c0d8c0d1600d90e1700120103006a0e0c0d8c0d1700d90e180012000b00120103006a0e0c0d8c0d1800d90e190012000b00120103006a0e0c0d8c0d1900d90e1a0012000b00120103006a0e0c0d8c0d1a00d90e1b00120103006a0e0c0d8c0d1b00d90e1c0012010300120107006a0e0c0d8c0d1c00d90e1d0012010700120108006a0e0c0d8c0d1d00d90e1e0012010700120108006a0e0c0d8c0d1e00d90e1f0012010800120107006a0e0c0d8c0d1f00d90e200012010700120103006a0e0c0d8c0d2000d90e210012010700120103006a0e0c0d8c0d2100d90e220012010700120103006a0e0c0d8c0d2200d90e230012010800120107006a0e0c0d8c0d2300d90e24006a0e0c0d8c0d2400d90e25001200040012000200120103001201070012000100120201006a0e0c0d8c0d2500d90e260012010a0012010700120109006a0e0c0dd90d2700120000001201030012000c00d90e28001201090012010a001201060012010800120107001201030012000d001202020012000000c1030000820e020003031d03250324290b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f323334363c0118000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000040102010aa3010000fb010000520200009f010202fb020100520301009f020202dd0300009f0200008202000000003d01180000000000000000000001000000001b000001cb01a3000000ff000100250000008c1100006f1200006a1200116f0101006f0202006f0303006f0404006f0505006f0606006f0707006f0808006f0909006f0a0a006f0b0b006f0c0c006f0d0d006f0e0e006f0f0f006f101000c5000111010000006f0111006f0212006f0313006f0414006f0515006f0616006f0717006f0818006f0919006f0a1a006f0b1b006f0c1c006f0d1d006f0e1e006f0f1f006f102000c5000111110000006f0121006f0222006f0323006f0424006f052500c500010621000000ff010100250000008c1200008c1301006a1301128c0202008c0301008c0401008c0501008c0602008c0701008c0802008c0901008c0a01008c0b01008c0c01008c0d01008c0e01008c0f01008c1001008c110100c5010211010000008c0201008c0301008c0401008c0501008c0601008c0703008c0801008c0901008c0a01008c0b01008c0c01008c0d01008c0e01008c0f01008c1003008c110300c5010211110000008c0201008c0301008c0401008c0502008c060100c501020621000000a4022700000060422b020700a4022900000080422b020400a4022b000000a0426f0326009f0202024d0302022c0000004d04027c2d0000004d0502702e000000a406310000c0f082a407330000c8f082a408350000d0f082a409370000d8f082a40a3a0000e48083a40b3c0000ecf082e20c41008c0d0100300d0c3b3d0000008c0d0400300d0c3f3e0000008c0d0400300d0cf93f000000c60d0000300d0c4240000000d90d000012000c001200060012000800d90e010012000d00d90f020012000e00d910030012000d00120003001200040012000500d911040012000d00120003001200040012000500d912050012000c0012000e0012000f00d913060012000c0012000e0012000f00d91407001200130012000c0012000600d915080012000e0012000d0012000c00c6160000d916090012001400120006001200120012000d0012000e0012000500120001001200030012000000120011001201160012000c00d9170a0012000c001200150012011600d9180b0012000a001200180012000b00d9190c001200170012001800a41a43000000204430191a2644000000c11600008200010045033e033f0340034103420343034403450346034703480349034a034b034c034d034e034f0350035103520353035403550356035703580359035a035b035c035d035e035f036003610362036303640400006042036504000080420366040000a042036703680369036a036b0400c0f082036c0400c8f082036d0400d0f082036e0400d8f0820337036f0400e4808303700400ecf0820302030c0308030105043d3e3f400371040000204403720d000102030405060708090a37380001180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000039";
	std::string LBIRaw;
	for (ulong Idx = 0; Idx < LBIByte.length(); Idx += 2)
	{
		std::string Byte = LBIByte.substr(Idx, 2);
		LBIRaw.push_back((char)((int)strtol(Byte.c_str(), 0, 16)));
	}

	std::string RandChunkName = RANDSTR(RANDINT(8, 12));
	//Console::WriteLine(RandChunkName);
	Console::Info(0, OBFUSCATESTR("Deserializing..."));
	RLua::deserialize(LBIrL, RandChunkName.c_str(), LBIRaw.c_str(), LBIRaw.length());
	Console::Info(0, OBFUSCATESTR("Spawning..."));
	RLua::spawn(LBIrL);
	RLua::settop(LBIrL, 0);
	Console::Info(1, OBFUSCATESTR("LBI Loaded!"));
}

void Execute(std::string Script)
{
	ulong ScriptRL = RLua::newthread(rL);
	setthreadidentity(ScriptRL, 7);
	lua_State* L = luaL_newstate();
	luaL_openlibs(L);
	int Compiled = luaL_loadbuffer(L, Script.c_str(), Script.length(), RANDSTR(RANDINT(8, 12)).c_str());
	if (Compiled == 0)
	{
		lua_getglobal(L, OBFUSCATESTR("string"));
		lua_getfield(L, -1, OBFUSCATESTR("dump"));
		lua_pushvalue(L, -3);
		lua_pcall(L, 1, -1, 0);

		size_t VanillaBytecodeLength;
		const char* VanillaBytecode = lua_tolstring(L, -1, &VanillaBytecodeLength);
		lua_close(L);

		// LARGE NOTE!!! READ PLEASE!!!
		// this needs a lot of work skp the next line to skip rage
		// THIS IS SO HACKY I HATE THIS AND IT ALSO WORKS LIKE ONE TIME WITH ONLY THE SIMPLEST THINGS
		// im working on making the lua c way work because it keeps erroring for some reason?
		// just made this quickly so i can push a successful build
		std::ostringstream BytecodeStm;
		BytecodeStm << "0105025F470C6C6F616462797465636F6465056572726F7256436F6E67726174756C6174696F6E73206964696F742C20796F752064656C657465642074686520636F72652066756E6374696F6E20746F206C6F616420627974636F64652E20486F7720646F20796F75206665656C3F";
		BytecodeStm << std::setfill('0') << std::setw(2) << std::hex << VanillaBytecodeLength;
		for (uint Idx = 0; Idx < VanillaBytecodeLength; Idx++)
		{
			BytecodeStm << std::setfill('0') << std::setw(2) << std::hex << (int)(byte)VanillaBytecode[Idx];
		}
		BytecodeStm << "010200000112A3000000A4010100000000404D000126020000002B000500A4000400000030406F0105009F00020182000100A4010100000000404D000126020000006F0106009F00020182000100070301040000004003020303040000304003040305000001180000000000000100000003FF000000000001010000000000";
		std::string Bytecode = BytecodeStm.str();
		std::string BytecodeRaw;
		for (ulong Idx = 0; Idx < Bytecode.length(); Idx += 2)
		{
			std::string Byte = Bytecode.substr(Idx, 2);
			BytecodeRaw.push_back((char)((int)strtol(Byte.c_str(), 0, 16)));
		}

		std::string RandChunkName = RANDSTR(RANDINT(8, 12));
		//Console::WriteLine(RandChunkName);
		Console::Info(0, OBFUSCATESTR("Deserializing..."));
		RLua::deserialize(ScriptRL, RandChunkName.c_str(), BytecodeRaw.c_str(), BytecodeRaw.length());
		Console::Info(0, OBFUSCATESTR("Spawning..."));
		RLua::spawn(ScriptRL);
		RLua::settop(ScriptRL, 0);
		Console::Info(1, OBFUSCATESTR("Loaded!"));

		//RLua::getglobal(ScriptRL, "_G");
		//Console::WriteLine("1");
		//RLua::getfield(ScriptRL, -1, "loadbytecode");
		//Console::WriteLine("2");
		//RLua::pushlstring(ScriptRL, VanillaBytecode, VanillaBytecodeLength); // error??? why?
		//Console::WriteLine("3");
		//RLua::pcall(ScriptRL, 1, -1, 0);
		//Console::WriteLine("4");
	}
	else
	{
		lua_close(L);
		RLua::getglobal(ScriptRL, OBFUSCATESTR("warn"));
		RLua::pushstring(ScriptRL, lua_tostring(L, -1));
		RLua::pcall(ScriptRL, 1, 0, 0);
	}
}

int main()
{
	SETSEED();
	EyeStep::open(GetCurrentProcess());
	Console::Open();
	GetRobloxLuaState();
	LoadLBI();
	while (true)
	{
		std::string Script = Console::ReadLine();
		Execute(Script);
		Console::WriteLine(OBFUSCATESTR("Done!"));
	}
}

int __stdcall DllMain(HINSTANCE Instance, DWORD Reason, LPVOID Reserved)
{
	if (Reason == DLL_PROCESS_ATTACH)
	{
		CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)main, 0, NULL, NULL);
		return TRUE;
	}

	return FALSE;
}