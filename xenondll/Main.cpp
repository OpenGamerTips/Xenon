// Xenon DLL by H3x0R-OpenGamerTips
// Version: 2.0.3
// Credits: 
//     TheDoomed: EyeStep (Disassembler/Debugger)
//     DeepPain:  Motivation and support. Cool guy.
//     MellonYT:  His Lua type dumper inspired me.
// "Just because it's open sourced, doesn't mean you should skid it. Give the developers credit you selfish human bean."

#define USE_CLI_INTERFACE

#include "Main.hpp"
using Xenon::Console;
using Xenon::Utility;
using Xenon::Pipes;
using Xenon::AntiTaint;

ulong rL;
void GetRobloxLuaState()
{
	rL = EyeStep::util::debug_r32(RLua::gettopAddr + 3, EyeStep::R32_EBP, 8, 1)[0];
	RLua::GetTypes(rL);
	RLua::setthreadidentity(rL, 8); // Alright I'm joining in on this level 8 meme.
}

void LoadLBI()
{
	ulong LBIrL = RLua::newthread(rL);
	Console::Info(OBFUSCATESTR("LoadLBI"), OBFUSCATESTR("Loading LBI..."));
	std::string LBIByte = "017106737472696e6704627974650c72645f696e745f626173696306727368696674066c73686966740462616e640c72645f666c745f62617369630c72645f64626c5f62617369630972645f696e745f6c650972645f696e745f62650972645f666c745f6c650972645f666c745f62650972645f64626c5f6c650972645f64626c5f626505696e64657806736f757263650873746d5f62797465037375620a73746d5f737472696e6705735f737a740b73746d5f6c737472696e670b6373745f696e745f7264720b6373745f666c745f72647205735f696e7405735f696e730576616c7565026f70014103414243014201430162064f704172674b0569735f4b4201630569735f4b43034142780242780469735f4b0441734278037342781073746d5f696e737472756374696f6e7305735f6e756d0d73746d5f636f6e7374616e74730c73746d5f73756266756e63730c73746d5f6c696e65696e666f077661726e616d65077374617274706305656e6470630b73746d5f6c6f63766172730a73746d5f757076616c73096e756d757076616c73096e756d706172616d7304636f646505636f6e73740473756273056c696e65730669706169727307636f6e73745f4207636f6e73745f430c73746d5f6c75615f66756e63041b4c756115696e76616c6964204c7561207369676e61747572650661737365727413696e76616c6964204c75612076657273696f6e12696e76616c6964204c756120666f726d6174066c6974746c6503626967056572726f7216756e737570706f7274656420666c6f61742073697a6508407669727475616c1073746d5f6c75615f62797465636f64650570616972730573746f726512636c6f73655f6c75615f757076616c756573106f70656e5f6c75615f757076616c75650673656c656374012311777261705f6c75615f7661726961646963027063056d61746368135e282e2d293a2825642b293a25732b282e2b290130013f06666f726d61741125733a25693a205b25733a25695d2025730c6f6e5f6c75615f6572726f7203656e7606757076616c73077661726172677305737461636b046d6174680361627308746f6e756d6265722460666f726020696e697469616c2076616c7565206d7573742062652061206e756d6265721c60666f7260206c696d6974206d7573742062652061206e756d6265721b60666f72602073746570206d7573742062652061206e756d6265720473697a65046c6973740d657865635f6c75615f66756e63057063616c6c09657865635f777261700d777261705f6c75615f66756e630767657467656e76036269740562697433320772657175697265057461626c6506756e7061636b064f7041726752064f704172674e064f70417267550b72756e62797465636f6465210d04000014c00400008c040000520701005205020052060300a8050d00520a0000520b0700520c07004c290002a4090200000400809f0904028c0b0001260c0701b20a0b0c0908090a430404088b05f3ff820402000303010302040004008000030118000107000000000000000000000000000000000263000000000d0401004dc00400008c05fffffb0700004d06070200000000520703008c0807009f060302b2040506fb0700004d06070200000000520702008c0807009f060302fb0800004d07087c01000000fb0900004d08097002000000520903008c0a7f009f0803028c0901009f07030243050607fb0900004d08097c01000000520901008c0a08009f08030243070008fb0900004d08097c01000000fb0a00004d090a7002000000520a02008c0b7f009f0903028c0a10009f080302430607088c0701008c0800009a050900080000008c0800009a060300080000005b080403820802008c0700008c05010065000a008c087f009a050800080000008c0800009a060300080000005b080404820802005b080405820802008c0b0200780c0506b20a0b0c0909040a8c0b01003e0c0707430a0b0c0908090a820802000803040305030602000000000000000002000000000000f07f02000000000000f8ff020000000000c05f400200000000000060410007011800010000000000000001000000000000000000000000000000000001000000000000000000000000000000000000010200000100000100020100020000010000010002000400000000000000007200000000120801004bc00800008c09fffffb0b00004d0a0b0200000000520b07008c0c07009f0a0302b208090afb0b00004d0a0b7c01000000fb0c00004d0b0c7002000000520c07008c0d7f009f0b03028c0c04009f0a0302fb0c00004d0b0c0200000000520c06008c0d04009f0b030243090a0bfb0c00004d0b0c7002000000520c06008c0d0f009f0b03025b0a0b038c0b01005b11050443100a115b110405430f10115b100306430e0f105b0f0207430d0e0f5b0e0108430c0d0e430a0c008c0c00009a0909000c0000008c0c00009a0a03000c0000005b0c0809820c02008c0b00008c09010065000a008c0cff079a0908000c0000008c0c00009a0a03000c0000005b0c080a820c02005b0c080b820c02008c0f02007810090cb20e0f10090d080e3e0f0a0d430e0b0f090c0d0e820c02000e03040305030602000000000000f04202000000000000704202000000000000f04102000000000000704102000000000000f04002000000000000704002000000000000000002000000000000f07f02000000000000f8ff020000000000f88f40020000000000003043000801180001000000000000000100000000000000000000000000000000000100000000000001020000000000000000000002000001000001000201000200000100000100020004000000000000008c000000000803010008c0030000fb0300005204000052050100780602008c0701009f030500820300000102000000000000f03f000901180000000000000000aa000000000803010008c0030000fb0300005204000078050200520601008c07ffff9f030500820300000102000000000000f03f000a01180000000000000000b000000000070201000bc0020000fb0200005204000052050100950601004c290002a4030300000810809f0304009f0200008202000004020000000000000840030103020400081080000b01180000000000000000000000b5000000000b0201000fc00200005203000052040100950501004c290002a4020300000810809f020405fb060000520705005208040052090300520a02009f0605008206000004020000000000000840030103020400081080000c0118000100000000000001000000000000ba00000000070201000bc0020000fb0200005204000052050100950601004c290002a4030300000810809f0304009f0200008202000004020000000000001c40030103020400081080000d01180000000000000000000000c2000000001302010013c00200005203000052040100950501004c290002a4020300000810809f020409fb0a0000520b0900520c0800520d0700520e0600520f05005210040052110300521202009f0a0900820a000004020000000000001c40030103020400081080000e011800010000000000000100000000000000000000c700000000060100000fc00100004d010002000000004d0300620100000052040100520501004c290002a4020400000c20809f0204029503010530030002000000008202020006030f03100301030204000c208002000000000000f03f00110118000100010000000000000002000001d4000000000702000010c00200004d03000200000000430203014d040062010000004d05000200000000780602024c2d0002a4030500001030809f03040230020002000000008203020006030f031002000000000000f03f0301031204001030800013011800010000010000000000000000020001df000000000701010014c0010000bc01001a000000009f010202c60200008c030000f1010c0003000000fb04000052050000520601009f0403028c0501008c06feff4c2d0002a4030300000810809f0304025202030082020200040314030103120400081080001501180001000001020000000000000000000000000002e900000000060102000fc00100004d02000200000000fb03000043010203fb0201004d030062010000004d04000200000000520501009f02040230010002000000008202020002030f031000000118000100000001000000000000010002f6000000000302000005c0020000d902000012000000120001008202020000010c1601180001000000f500000000050102000ec0010000fb0100004d020062000000004d030002010000009f0103024d03000201000000fb04010043020304300200020100000082010200020310030f00000118000100000000000100000000000203010000000302000005c0020000d902000012000100120000008202020000010e17011800010000000201000000100103009301c0010000bc0100e9000000009f010202ff020000000000008c050100520301008c040100a8038800bc0600a3010000009f060202fb0800004d07087002000000520806008c093f009f070302fb09010087080907fb0a020087090a07e20a060030060acc0300000030070a6904000000fb0c00004d0b0c7002000000fb0d00004d0c0d0207000000520d06008c0e06009f0c03028c0dff009f0b0302300b0a60050000006f0b08009a083a000b000000fb0c00004d0b0c7002000000fb0d00004d0c0d0207000000520d06008c0e17009f0c03028c0dff019f0b0302300b0a6309000000fb0c00004d0b0c7002000000fb0d00004d0c0d0207000000520d06008c0e0e009f0c03028c0dff019f0b0302300b0a620a000000a90b00004d0c09830b0000006f0d0c009a0c08000d0000004d0c0a63090000008c0dff00b70d02000c000000a90b0001a90b0100300b0a660d000000a90b00004d0c09820e0000006f0d0c009a0c08000d0000004d0c0a620a0000008c0dff00b70d02000c000000a90b0001a90b0100300b0ae20f00000065002b006f0b10009a0818000b000000fb0c00004d0b0c7002000000fb0d00004d0c0d0207000000520d06008c0e0e009f0c03026f0d11009f0b0302300b0a0a120000004d0c09830b0000006f0d0c00f10c02000d000000a90b0001a90b0100300b0a2513000000650011006f0b14009a080f000b000000fb0d00004d0c0d7002000000fb0e00004d0d0e0207000000520e06008c0f0e009f0d03026f0e11009f0c0302780b0c15300b0a90160000006a0a02058b0378ff8202020017031803190306031a031b031c05030304050304031d031e031f0320032103220323032403250200000000f8ff0f410326032703280200000000f0ffff400329002a011800010000010002000000010000010000000000010001000100000000000000000000000000000000000200000100000000000000000000000001000000000000000000000000010000000000000000000000000000010000000000000000000000000000000100000100000000000000000000000001000000000000000000010000010000000000000000000000000003ed160b010000000a0102002cc0010000bc0100e9000000009f010202ff020000000000008c050100520301008c040100a8032100fb060000520700009f060202c60700008c0801009a060a0008000000fb080000520900009f0802028c0900009a08020009000000a9070001a907010065000f008c0803009a06060008000000bc0800e3010000009f08020252070800650007008c0804009a06050008000000fb080100520900009f080202520708006a0702058b03dfff82020200020318032b002c0118000100000100020000000100000102000001000000000000000001000001000000000100000100000003f40f28010000000a02010011c0020000bc0200e9000000009f020202ff030000000000008c060100520402008c050100a8040600fb07000052080000520901009f0703026a0703068b04faff82030200010318002d0118000100000100020000000100000000ff043e010000000801000010c0010000bc0100e9000000009f010202ff020000000000008c050100520301008c040100a8030500bc0600e9000000009f0602026a0602058b03fbff82020200010318002e0118000100000100020000000000000000024901000000090101001dc0010000bc0100e9000000009f010202ff020000000000008c050100520301008c040100a8031200e2060400fb070000520800009f0702023007068501000000bc0700e9000000009f0702023007062702000000bc0700e9000000009f07020230070690030000006a0602058b03eeff82020200050318032f03300331050301020300320118000100000100020000000000000000000000000000000000000000000252010000000801010010c0010000bc0100e9000000009f010202ff020000000000008c050100520301008c040100a8030500fb060000520700009f0602026a0602058b03fbff8202020001031800330118000100000100020000000000000000025b010000000d02080064c0020000ff02000000000000fb040000520500009f040202ca0304013003026200000000bc0400e9010000009f040201bc0400e9010000009f040201fb040100520500009f040202300402d702000000fb040100520500009f040202300402a503000000fb040100520500009f040201fb040100520500009f040201fb040200520500009f0402023004022304000000fb040300520500009f0402023004029005000000fb04040052050000520603009f0403023004029c06000000fb040500520500009f040202300402e107000000fb040600520500009f040201fb040700520500009f"
		"040201a4040900000080404d050223040000009f040204510422004d0908250a0000000e0909004d0a0290050000004d0c080a0c000000950b0c0b87090a0b3009089005000000650016004d0908660d0000000e0908004d0a0290050000004d0c08630f000000780b0c0e87090a0b300908e9100000004d0908e2110000000e0908004d0a0290050000004d0c086212000000780b0c0e87090a0b30090884130000003404ddff820202001403100318033403350336033703380339033a0400008040032702000000000000f03f03260322020000000000e06f40031e033b0324031f033c003d01180001000100000002000200000100000200000000010000000002000001000002000000000100000000010000000000010000000002000001000003000000000001000001000000000000000002000000000000000000000200000000000000000000fa0a64010000000e0108008e01c0010000c6010000c6020000c6030000c6040000c6050000c6060000c6070000e20802008c09010030090802000000003000086201000000fb0b0000520c08008c0d04009f0b03026f0c0300f10b02000c000000a90a0001a90a01006f0b04004c010002a4090600000050409f090301fb0b0100520c08009f0b02028c0c5100f10b02000c000000a90a0001a90a01006f0b07004c010002a4090600000050409f090301fb0b0100520c08009f0b02028c0c0000f10b02000c000000a90a0001a90a01006f0b08004c010002a4090600000050409f090301fb090100520a08009f0902028c0a00009a0902000a000000a9020001a9020100fb090100520a08009f09020252030900fb090100520a08009f09020252040900fb090100520a08009f09020252050900fb090100520a08009f09020252060900fb090100520a08009f0902028c0a00009a0902000a000000a9070001a90701000e020200fb0902002b090100fb09030052010900fb090400520a0300520b01009f090302300908e909000000fb090400520a0400520b01009f0903023009081a0a000000fb090400520a0500520b01009f090302300908a30b0000000e070700fb090400520a0600520b01009f090302300908e30c00000065001400fb0a050087090a060e090d00fb090600520a0600fb0d0500870c0d060e0202006f0d0d00650001006f0d0e00870b0c0d9f090302300908e30c00000065000400a40910000000f0406f0a11009f090201fb090700520a08006f0b12009f0903008209000013030f031005020001033e033f0340040000504003410342031803140319032b034303440345040000f04003460347004801180002030101010101030200000100030000000000000000000000000001000000000000000000000000010000000000000000000000000200000000000000010000000100000001000000010000000100000000000000020000000001000000000001000000000001000000000002010000000000000100000100000000000000000000000002000000030000000089010000000a0200001ac0020000a402010000000040520300009f020204170212004d070602020000007d010f00070000004d08067e030000004d0906020200000087070809300706cc040000003006067e030000006f0704003007060202000000c60700006a070005fa02edff820001000503490400000040030f034a031a004b0118000100000000010000000100000000000001000100000100fb08b701000000050300000bc0030000870300012b030700e204020030010402000000003002047e01000000520304006a0300018203020003030f034a05020001004c01180001020100000000000103c201000000030000010ca3000000a4000100000000406f010200dd0200009f000002ff01000000000000dd020000c5010200010000008200030003034d0400000040034e004f0118000000000000000000000000cd010000000f02000020c00200004d020062000000004d0400e1010000004d060019030000007805060287030405a404060000144080520501006f0607009f040304900303089004040990050508ca060601a4070b000000a040a4080d00003040806f090e00520a0200520b0300520c0400520d0500520e06009f0807028c0900009f070301820001000f0310033902000000000000f03f03500301035104001440800352035303540345040000a040035504003040800356005701180001000100000000000100000000030101010200000000000000000000000001cf0100000018010500c007c00100004d010023000000004d02009c010000004d03009c020000004d0400db030000004d0500b0040000008c06ffffff070000000000004d08009d050000004d09001906000000870a01094d0b0a6907000000950909088c0c1300600b69010c0000008c0c0900600b79000c0000008c0c0400600b32000c0000008c0c0200600b11000c0000008c0c0100600b08000c0000004d0c0a60090000004d0e0a630a000000870d080e6a0d080c650090034d0c0a60090000004d0d0a900b0000006a0d080c65008a038c0c0200600c0b000b0000004d0e0a60090000004d0c0a630a0000008c0d0100a80c8103c60f00006a0f080e8b0cfdff65007d034d0c0a60090000004d0e0a630a0000008c0f00009a0e02000f000000a90d0001a90d01006a0d080c4d0c0a620c0000008c0d0000f10c6f030d0000009509090865006c038c0c0400600c36000b0000008c0c0700600b1d000c0000008c0c0600600b08000c0000004d0c0a60090000004d0e0a900b000000870d030e6a0d080c65005c03c60c00004d0d0ae20d0000000e0d03004d0c0a840e000000650003004d0d0a620c000000870c080d4d0d0a60090000004d100a630a000000870f0810870e0f0c6a0e080d65004a038c0c0700600c0d000b0000004d0d0a630a000000870c040d4d0d0c7e0f0000004d0e0c02100000004d100a6009000000870f08106a0f0d0e65003b034d0c0a900b0000004d0e0a6009000000870d080e6a0d030c650034034d0d0a630a000000870c040d4d0d0a60090000004d0f0c7e0f0000004d100c0210000000870e0f106a0e080d650028038c0c0900600cd2000b0000008c0c0e00600b57000c0000008c0c0c00600b1f000c0000008c0c0b00600b07000c0000004d0c0a6009000000ff0d0000000000006a0d080c650016034d0c0a60090000004d0d0a630a000000c60e00004d0f0ae20d0000000e0f03004d0e0a840e000000650003004d0f0a620c000000870e080f950f0c088710080d6a10080f8710080d870f100e6a0f080c650001038c0c0c00600c1a000b000000c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0e0a6009000000260f0c0d6a0f080e6500e502c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0e0a6009000000430f0c0d6a0f080e6500cc028c0c0e00600c5d000b0000008c0c1100600b36000c0000008c0c1000600b1a000c000000c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0e0a6009000000ec0f0c0d6a0f080e6500aa02c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0e0a6009000000cf0f0c0d6a0f080e650091028c0c1100600c09000b0000004d0c0a60090000004d0f0a630a000000870e080f390d0e006a0d080c65008602c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0e0a6009000000b20f0c0d6a0f080e65006d02c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0e0a6009000000090f0c0d6a0f080e65005402c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080e4d0f0a6009000000870e080f6a0d0e0c65003b028c0c1300600c32020b0000008c0c1d00600bee000c0000008c0c1800600b4b000c0000008c0c1600600b1e000c0000008c0c1500600b09000c0000004d0c0a60090000004d0f0a630a000000870e080f1c0d0e006a0d080c650024024d0d0a630a000000870c080d4d100a630a000000950f10084d0d0a620c0000008c0e0100a80d040052100c008711080f730c10118b0dfcff4d0d0a60090000006a0c080d650012028c0c1600600c24000b000000c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080ef10c02000d000000a90e0001a90e01004d100a60090000008c1100009a10020011000000a90f0001a90f0100f10eef010f000000950909086500ec014d0c0a90130000004309090c6500e8018c0c1800600c7b000b0000008c0c1b00600b36000c0000008c0c1a00600b24000c000000c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080ed40c02000d000000a90e0001a90e01004d100a60090000008c1100009a10020011000000a90f0001a90f0100f10ebf010f000000950909086500bc014d0e0a6009000000870d080e560c0d004d0e0a620c0000008c0f00009a0e02000f000000a90d0001a"
		"90d01009a0cb0010d000000950909086500ad018c0c1b00600c2c000b0000004d0c0a60090000004d0d0a630a0000004d0e0a620c000000c60f0000c6100000c61100008c1200009a0d030012000000260f060c65000100780f0d08fb1200008713080cfb1401005215080095160c0843170c0f9f1404009f1300009f12000352101200521113008c1200009a0e04001200000043120c10780612086500010078100e088c140100521210008c130100a812850143160c1478151608871611146a1608158b12fbff65007f014d0c0a60090000004d0d0a630a000000870f080d560e0f004d100a620c0000008c1100009a10020011000000a90f0001a90f01009a0e03000f0000009509090865006e01870e080d6a0e080c65006b01c60c0000c60d00004d0e0a66110000000e0e03004d0c0ae912000000650003004d0e0a630a000000870c080e4d0e0ae20d0000000e0e03004d0d0a840e000000650003004d0e0a620c000000870d080eb70c02000d000000a90e0001a90e01004d100a60090000008c1100009a10020011000000a90f0001a90f0100f10e4b010f00000095090908650048018c0c1d00600c25010b0000008c0c2200600ba7000c0000008c0c2000600b47000c0000008c0c1f00600b1f000c0000004d0c0a60090000004d0d0a630a000000ff0e000000000000c60f00008c1000009a0d0400100000002610060c950f100865000100780f0d088c12010052100f008c110100a810050043150c1278141508871308146a130e128b10fbfffb100200521107008c1200009f10030152100f0052110e00821003004d0c0a6009000000950e0c14870d080e870f080c430e0f0d95100c08870f0810c610000052120d004c020002a4111700005850819f1102029a0d060011000000d40e02000f000000a9100001a910010065000400d40f02000e000000a9100001a91001000e1004014d110a60090000006a0e08114d120a6009000000951112186a0e08114d110a9013000000430909116500f9008c0c2000600c2c000b0000004d0c0a6009000000870d080c950f0c08870e080f95100c14870f081095100c18c6110000951210146a0f0812951210086a0e08126a0d0810ff1200000100000052130d0052140e0052150f009f130300c512130001000000521112008c1401004d120a620c0000008c130100a81205004316101478151608871611146a1608158b12fbff87120810c6130000f11205001300000095120c14871308106a1308126500cd00950909086500cb004d0c0a6009000000c60d0000c60e0000c60f0000a4111a00000090418712080c9f1102026f121b004c010002a4101d000000c0419f100302520d1000a4111a000000904195130c08871208139f1102026f121e004c010002a4101d000000c0419f100302520e1000a4111a000000904195130c14871208139f1102026f121f004c010002a4101d000000c0419f100302520f100026100d0f6a10080c95100c086a0e081095100c146a0f08104d100a90130000004309091065009c008c0c2200600c5a000b0000008c0c2400600b07000c000000fb0c0200520d07004d0e0a60090000009f0c0301650090008c0c2400600c18000b0000004d0c0a60090000004d0d0a630a0000008c0e00009a0d05000e0000004d0d050f20000000430e0c0d78060e088c100100520e0d008c0f0100a80e7e0043120c10781112084d13050b21000000871213106a1208118b0ef9ff650076004d0e0a0a22000000950d0e08870c020d4d0d0cd723000000c60e00008c0f0000f10d24000f000000ff0e0000000000008c110100520f0d008c100100a80f1c004314091178131408871201134d131269070000008c1400009a130a001400000078131108fb140300521507004d1612630a000000521708009f1404026a140e1365000a004d131269070000008c1404009a13060014000000781311084d1512630a000000871404156a140e138b0fe4ff4309090d4d0f0a6009000000fb10040052110c005212030052130e009f1004026a10080f650040004d0c0a60090000004d0d0a620c0000004d0e0a630a000000870f080cc61000008c1100009a0e020011000000260e060c8c1100009a0d05001100000087110a094d0d11cc240000009509090878110d085b1011258c13010052110e008c120100a81127004314131043160c13871508166a150f148b11fbff650021004d0c0a60090000004d0d0a630a000000c60e00008c0f00009a0d03000f000000260e060c65000100780e0d08fb0f0200521007008c1100009f0f0301fb0f00008710080cfb1101005212080095130c0843140c0e9f1104009f1000009f0f0000820f0000650007004d0c0a60090000004d0f0a630a000000870e080f560d0e006a0d080c3009001906000000480053fc82000100260336033803580359035a035b0350031b02000000000000f03f031c031e0337031f0324033c034a030f0322033b0329020000000000000040035c035d0400585081020000000000000840035e0400009041035f0340040000c041036003610362036303260334031a02000000000000494000640100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dd010000020000000000000001000000000000000100000000000000010000000000000001000000000000000300000001000000000000000100000000000000010000000000000003000000010000000000000001000000020000000000000000000000010000000000000000000000010000000000000000000000010000000000000000000000010000000000000000000000020000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000200000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000200000000000000000000000100000000000000000000000100000000000000000000000200000000000000000000000000000000000000000000000000000003000000020000000000000000000000010000000000000000000000020000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000002000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000040000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000010000000000000000000000010000000000000000000000010000000000000000000000020000000000000000000000000000000000000000000000030000000000000001000000000000000100000002000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000001000000000000000000000000000000020000000000000000000000020000000000000002000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000000000000000000000300000000000000020000000000000000000000010000000000000000000000020000000000000000000000030000000000000000000000010000000000000000000000020000000000000000000000030000000000000000000000000000000000000002000000000000000000000001000000000000000000000001000000000000000000000002000000000000000200000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000000000000000000030000000000000002000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000000000000000000000200000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000002000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000000000000000000000400000000000000020000000000000000000000010000000000000000000000020000000000000000000000030000000000000000000000010000000000000000000000020000000000000000000000030000000000000000000000000000000000000004000000000000000200000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000000000000000000020000000000000000000000010000000000000000000000010000000000000000000000010000000000000000000000010000000000000000000000020000000000000000000000000000000000000000000000000000000000000003000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000002000000000000000000000002000000000000000200000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000002000000000000000000000001000000000000000000000001000000000000000000000002000000000000000200000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000100000000000000000000000200000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000200000000000000010000000000000001000000000000000100000001000000000000000200000000000000000000000100000000000000020000000300000000000000000000000000000000000000000000000000"
		"00000000000000000000000000000000000002000000000000000000000001000000000000000000000002000000030000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000010000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000020000000000000000000000050000000000000002000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000001000000000000000000000002000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000001000000000000000000000001000000000000000000000001000000000000000000000002000000000000000100000000000000010000000000000001000000020000000000000000000000010000000000000000000000020000000300000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000001000000000000000000000003000000000000000100000000000000010000000000000001000000000000000100000002000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000002000000000000000000000000000000030000000100000000000000000000000100000000000000000000000000000001000000000000000000000000000000030000000000000000000000020000000000000001000000010000000000000001000000000000000100000001000000020000000000000001000000000000000100000002000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000100000000000000000000000000000002000000000000000400000000000000010000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000100000000000000010000000000000002000000000000000000000000000000020000000000000000000000010000000000000000000000020000000000000000000000000000000000000000000000010000000000000000000000020000000000000001000000000000000200000000000000000000000100000000000000010000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000010000000000000001000000020000000000000000000000010000000000000002000000000000000000000000000000010000000000000000000000020000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000100000000000000000000000000000000000000faffffff0a00000003000000000000000000000000000000000000000000000000000000000000000000000004000000000000000100000000000000010000000000000001000000010000000200000000000000000000000000000002000000000000000000000001000000000000000000000001000000030000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000001000000000000000100000002000000000000000000000001000000000000000200000003000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000030000000000000027feffffdb010000000f000b0158a3000000ff00000000000000ff010000000000008c020000fb030000dd0400009f030003c6050000c6060000c6070000c60800008c0b0100fb0901008c0a0100a8090400780c0b00870d040b6a0d000c8b09fcfffb09010060090c0003000000fb090100260203098c0b0100520902008c0a0100a8090500fb0e0100430d0e0b870c040d6a0c010b8b09fbffe2090a00e20a0d0030010a0b0b00000030020a0f0c000000300a09b001000000fb0a0200300a092302000000fb0a0300300a099c03000000fb0a0400300a09e104000000fb0a0500300a096205000000fb0a0600300a099c06000000fb0a0700300a09db070000003000099d080000008c0a0100300a09190900000052050900a4090f000000e040fb0a0800520b0500dd0c00009f0900045206090052070a0052080b000e060600fb090900520a08008c0b0100520c07009f09040082090000fb090a00520a0500520b07009f090301820001001002000000000000f03f035a033603380339031003580359035b035005090102030405060708090363036205020b0c0365040000e0400066011800010001000101000002010000020000000000000002000001000100000000000000000301000000000000010000010000010000010000010000010000010001000000030000000000000000020100000000000200000003cf030000000903040018c00300004d030023000000004d04009c010000004d0500e1020000004d060062030000004d0700a504000000d90800001202000012000700120003001200040012000500120006001200010012000200120201001202020012020300820802000503360338033903100335011d670118000100010001000100010002000000000000000000000027c803000000040102000bc0010000fb010000fb020100520300009f020202a4030100000000409f0301009f0100029f010100820100000203680400000040000001180001000000000000000000f90300000023000001b703a3000000a4000100000000402b000700a4000300000020402b000400a4000500000040406f0100009f000202a4010800001c60802b010200a401090000007040c6020000c6030000c6040000ff050100250000008c1600006f170a006a1705166f060b006f070a006f080a006f090a006f0a0b006f0b0a006f0c0b006f0d0a006f0e0a006f0f0a006f100a006f110a006f120a006f130a006f140a006f150a00c5050611010000006f060a006f070a006f080a006f090a006f0a0a006f0b0c006f0c0a006f0d0a006f0e0a006f0f0a006f100a006f110a006f120a006f130a006f140c006f150c00c5050611110000006f060a006f070a006f080a006f090b006f0a0a00c505060621000000ff060100250000008c170000e2180f006f191000301918830d0000006f191100301918820e0000006a180617e2070f006f081200300807830d0000006f081100300807820e000000e2080f006f091300300908830d0000006f091300300908820e000000e2090f006f0a1000300a09830d0000006f0a1100300a09820e000000e20a0f006f0b1300300b0a830d0000006f0b1100300b0a820e000000e20b0f006f0c1200300c0b830d0000006f0c1100300c0b820e000000e20c0f006f0d1000300d0c830d0000006f0d1200300d0c820e000000e20d0f006f0e1200300e0d830d0000006f0e1100300e0d820e000000e20e0f006f0f1300300f0e830d0000006f0f1100300f0e820e000000e20f0f006f10120030100f830d0000006f10120030100f820e000000e2100f006f111300301110830d0000006f111300301110820e000000e2110f006f121000301211830d0000006f121200301211820e000000e2120f006f131200301312830d0000006f131200301312820e000000e2130f006f141200301413830d0000006f141200301413820e000000e2140f006f151200301514830d0000006f151200301514820e000000e2150f006f161200301615830d0000006f161200301615820e000000e2160f006f171200301716830d0000006f171200301716820e000000c506071101000000e2070f006f081200300807830d0000006f081200300807820e000000e2080f006f091000300908830d0000006f091100300908820e000000e2090f006f0a1000300a09830d0000006f0a1100300a09820e000000e20a0f006f0b1000300b0a830d0000006f0b1100300b0a820e000000e20b0f006f0c1000300c0b830d0000006f0c1000300c0b820e000000e20c0f006f0d1000300d0c830d0000006f0d1100300d0c820e000000e20d0f006f0e1200300e0d830d0000006f0e1200300e0d820e000000e20e0f006f0f1200300f0e830d0000006f0f1200300f0e820e000000e20f0f006f10120030100f830d0000006f10120030100f820e000000e2100f006f111000301110830d0000006f111300301110820e000000e2110f006f121000301211830d0000006f121300301211820e000000e2120f006f131300301312830d0000006f131300301312820e000000e2130f006f141300301413830d0000006f141300301413820e000000e2140f006f151300301514830d0000006f151100301514820e000000e2150f006f161000301615830d0000006f161100301615820e000000e2160f006f171000301716830d0000006f171100301716820e000000c506071111000000e2070f006f081100300807830d0000006f081300300807820e000000e2080f006f091300300908830d0000006f091300300908820e000000e2090f006f0a1100300a09830d0000006f0a1100300a09820e000000e20a0f006f0b1300300b0a830d0000006f0b1100300b0a820e000000e20b0f006f17130030170b830d0000006f17110030170b820e000000c506070621000000d9070000d908010012000000d909020012000000d90a030012000700d90b040012000700d90c050012000800d90d060012000800d90e070012000900d90f080012000900ff100200000000008c110400e2121600300c128914000000300d1247150000006a1210118c110800e2121600300e128914000000300f1247150000006a121011d9110900d9120a00d9130b0012001200d9140c00d9150d00d9160e00120000001200050012000600d9170f001200110012001300d918100012010400d9191100d91a120012001300d91b130012001300d904140012001300120011001200160012001700120018001200190012001a0012001b00d9021500120012001200110012000a0012000b0012001400120010001200150012010400d91c1600d91d1700d91e1800d91f1900d9201a0012001e001200010012001c0012001d0012010300d9031b0012001e00120020001200010012001f00a4211800000070419f210102d9221c001201030012010200302221d119000000c1020000820001001a03690400000040036a0400002040036b0400004040036c036d04001c60800400007040031d032503280320032305020d0e036e036f0321037003430344050214150368040000704103711d000102030405060708090a0b0d0f101112131415161718191a1b1c1e1f00010300000000000000000000000100000000ff01010600010000f701010101010101f901010101010101f900000101010101fb01010101010101f901010000010101fb00000300010000fc00000000000100ff00000000010000ff00000001000000ff00000100000000ff00010000000000ff01000000000000ff00000000000001ff00000000000100ff00000000010000ff00000001000000ff00000100000000ff00010000000000ff01000000000000ff00000000000001ff00000000000100ff00000000000001ff00000000000100ff00000000010000ff00000001000000ff00000100000000ff00010000000000ff01000000000000ff00000000000001ff00000000000100ff00000000010000ff00000001000000ff00000100000000ff00010000000000ff01000000000000ff000000000000000001000000000000ff00000000000001ff00000000000100ff00000000000008f8001a001e000600c200050008000500ee00010000000000ff01000000000000ff0b0a000c0d0900c9001d000016000bc200090009000000ee00000000250000db00000000002e0bc7020e0000000000f000000000310000cf0000000002000100000000000000030000000a00000008000000080000000600000008000000060000000400000001000000010000000100000001000000010000000200000001000000010000000100000001000000010000000100000002000000010000000100000001000000010000000100000001000000010000000100000002000000010000000100000001000000010000000100000001000000020000000000000002000000010000000100000017000000430000001800000001000000060000003700000047000000120000002500000044000000fb010000310000000020";
	std::string LBIRaw;
	for (ulong Idx = 0; Idx < LBIByte.length(); Idx += 2)
	{
		std::string Byte = LBIByte.substr(Idx, 2);
		LBIRaw.push_back((char)((int)strtol(Byte.c_str(), 0, 16)));
	}

	std::string RandChunkName = RANDSTR(RANDINT(8, 16)); // My OCD....help me please
	//Console::WriteLine(RandChunkName);
	RLua::deserialize(LBIrL, RandChunkName.c_str(), LBIRaw.c_str(), LBIRaw.length());
	RLua::spawn(LBIrL);
}

void Execute(std::string Script)
{
	ulong ScriptRL = RLua::newthread(rL);
	lua_State* L = luaL_newstate();
	luaL_openlibs(L);
	int Compiled = luaL_loadbuffer(L, Script.c_str(), Script.length(), RANDSTR(RANDINT(8, 16)).c_str());
	if (Compiled == 0)
	{
		lua_getglobal(L, OBFUSCATESTR("string"));
		lua_getfield(L, -1, OBFUSCATESTR("dump"));
		lua_pushvalue(L, -3);
		lua_call(L, 1, 1);

		size_t VanillaBytecodeLength;
		const char* VanillaBytecode = lua_tolstring(L, -1, &VanillaBytecodeLength);
		lua_close(L);
		
		RLua::getfield(ScriptRL, -10002, OBFUSCATESTR("runbytecode"));
		RLua::pushlstring(ScriptRL, VanillaBytecode, VanillaBytecodeLength);
		RLua::pcall(ScriptRL, 1, -1, 0);
	}
	else
	{
		std::string CompileErr = lua_tostring(L, -1);
		RLua::print(2, CompileErr.c_str());
		lua_close(L);
	}
}

void PipeThread()
{
	Pipes::ListenPipe(OBFUSCATESTR("XenonPipe"), Execute);
}

void InitializeEverything()
{
	AntiTaint::Init(); // Probably the first thing we want to do.
	EyeStep::open(GetCurrentProcess()); // Initialize EyeStep (lol thx thedoomed)
	GetRobloxLuaState(); // Steal a Roblox Lua state
	Console::Info(OBFUSCATESTR("InitializeEverything"), OBFUSCATESTR("Lua State: 0x") + std::to_string(rL));
	SETSEED();
	RFunctions::Init(rL); // Bypass callcheck and define functions.
	Console::Info(OBFUSCATESTR("InitializeEverything"), OBFUSCATESTR("Defined functions."));
}

int main()
{
	ulong InjectStart = TimeSinceEpoch();
	Console::Open(OBFUSCATESTR("Xenon v2.0.3a")); // Bypass and open the console
	Console::Info(OBFUSCATESTR("main"), OBFUSCATESTR("Inject Timestamp: ") + std::to_string(InjectStart));
	InitializeEverything();
	LoadLBI();
	Console::Info(OBFUSCATESTR("main"), OBFUSCATESTR("Finished! Load Time: ") + std::to_string(TimeSinceEpoch() - InjectStart) + OBFUSCATESTR("ms")); // On my machine I get 50-70ms [insert-works-on-my-machine-badge-here]
#ifdef USE_CLI_INTERFACE
	while (true)
	{
		Console::Write(OBFUSCATESTR("Xenon> "));
		std::string Script = Console::ReadLine();
		Execute(Script);
	}
#else
	CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)PipeThread, 0, NULL, NULL);
#endif
}

int __stdcall DllMain(HINSTANCE Instance, DWORD Reason, LPVOID Reserved)
{
	if (Reason == DLL_PROCESS_ATTACH)
	{
		CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)main, 0, NULL, NULL);
		return TRUE;
	}

	return FALSE;
}